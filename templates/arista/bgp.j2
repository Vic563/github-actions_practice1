!
! BGP Configuration
!
router bgp {{ bgp.asn }}
   router-id {{ bgp.router_id }}
   maximum-paths {{ bgp.maximum_paths | default(4) }}

{%- if bgp.neighbors %}
   ! BGP Neighbors
{%- for neighbor in bgp.neighbors %}
   neighbor {{ neighbor.ip }} remote-as {{ neighbor.remote_as }}
   neighbor {{ neighbor.ip }} description {{ neighbor.description }}
   {%- if neighbor.password %}
   neighbor {{ neighbor.ip }} password {{ neighbor.password }}
   {%- endif %}
   {%- if neighbor.update_source %}
   neighbor {{ neighbor.ip }} update-source {{ neighbor.update_source }}
   {%- endif %}
   {%- if neighbor.next_hop_self %}
   neighbor {{ neighbor.ip }} next-hop-self
   {%- endif %}
   {%- if neighbor.route_map_in %}
   neighbor {{ neighbor.ip }} route-map {{ neighbor.route_map_in }} in
   {%- endif %}
   {%- if neighbor.route_map_out %}
   neighbor {{ neighbor.ip }} route-map {{ neighbor.route_map_out }} out
   {%- endif %}
   {%- endfor %}
   {%- endif %}
   
   {%- if bgp.networks %}
   ! Advertised Networks
   {%- for network in bgp.networks %}
   network {{ network.prefix }} mask {{ network.mask }}
   {%- endfor %}
   {%- endif %}
   
   {%- if bgp.redistribute %}
   ! Redistribution
   {%- for redist in bgp.redistribute %}
   redistribute {{ redist.protocol }}{% if redist.route_map %} route-map {{ redist.route_map }}{% endif %}
   {%- endfor %}
   {%- endif %}
!
